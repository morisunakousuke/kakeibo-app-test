<!DOCTYPE html>
<html lang="ja">
<head>
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>家計簿</title>

  <!-- favicon & PWAアイコン -->
  <link rel="icon" type="image/png" href="/kakeibo-app/image/favicon.png">
  <link rel="apple-touch-icon" href="/kakeibo-app/icons/icon-192.png">
  <link rel="manifest" href="/kakeibo-app/manifest.json">
  <meta name="theme-color" content="#2c3e50">

  <link rel="stylesheet" href="/kakeibo-app/css/index.css">

  <script>
    // スマホ判定
    const ua = navigator.userAgent.toLowerCase();
    const isMobile = /iphone|ipod|ipad|android/.test(ua) || window.innerWidth < 600;
    if (isMobile) {
      window.location.href = "/kakeibo-app/html/mobile.html?v=" + Date.now();
    }

    // Service Worker登録
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/kakeibo-app/service-worker.js')
          .then(() => console.log('✅ Service Worker registered'))
          .catch(err => console.log('❌ Service Worker failed', err));
      });
    }
  </script>
</head>

<body>
  <h1>家計簿入力</h1>

  <!-- 変動費・固定費ラジオボタン -->
  <div class="cost-type">
    <label><input type="radio" name="costType" id="variableCost" value="variable" checked> 変動費</label>
    <label><input type="radio" name="costType" id="fixedCost" value="fixed"> 固定費</label>
  </div>

  <form id="kakeiboForm" class="form">
    <label for="datepicker">日付</label>
    <input type="date" id="datepicker">

    <div class="form2">
      <label for="category">カテゴリ</label>
      <select id="category"><option value="">読み込み中...</option></select>

      <label for="text">テキスト</label>
      <input type="text" id="text">

      <label for="payer">支払者</label>
      <select id="payer"><option value="">読み込み中...</option></select>
    </div>

    <div class="money-group">
      <div><label>収入</label><input type="number" id="income" placeholder="0"></div>
      <div><label>食費</label><input type="number" id="meal" placeholder="0"></div>
      <div><label>生活用品</label><input type="number" id="supplies" placeholder="0"></div>
      <div><label>娯楽</label><input type="number" id="play" placeholder="0"></div>
      <div><label>生活費</label><input type="number" id="infra" placeholder="0"></div>
      <div><label>子供・教育</label><input type="number" id="education" placeholder="0"></div>
      <div><label>その他</label><input type="number" id="others" placeholder="0"></div>
    </div>

    <p id="message"></p>

    <div class="bottan">
      <button type="submit">登録</button>
      <button type="button" id="clearButton">クリア</button>
      <button type="button" id="adminBtn" onclick="location.href='html/AdministratorMenu.html'">管理者メニュー</button>
    </div>
  </form>

  <h2>家計簿内容</h2>
  <div class="month-nav">
    <button id="prevMonth">◀ 前月</button>
    <input type="month" id="datemonth" min="1801-01" max="2999-12">
    <button id="nextMonth">翌月 ▶</button>
  </div>

  <!-- 個人負担表・合計表 -->
  <div class="table-row">
    <div class="table-block">
      <table id="burdenTable">
        <thead>
          <tr><th>支払者</th><th>金額</th><th>精算済</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="table-block">
      <table id="totalTable">
        <thead>
          <tr>
           <th>収入合計</th><th>食事関係</th><th>雑貨・生活用品系</th>
           <th>遊び・娯楽関係</th><th>生活費関係</th><th>子供・教育</th>
           <th>その他</th><th>支出合計</th><th>収支</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- 固定費・変動費 -->
  <h3>固定費</h3>
  <div class="table-control">
    <button id="koteieditSelected">編集</button>
    <button id="koteideleteSelected">削除</button>
  </div>
  <div class="table-scroll-x">
    <table id="koteiTable">
      <thead>
        <tr>
          <th>選択</th><th>年月</th><th>カテゴリ</th><th>備考</th><th>支払者</th>
          <th>収入系</th><th>食事関係</th><th>雑貨・生活用品系</th>
          <th>遊び・娯楽関係</th><th>生活費関係</th><th>子供・教育</th><th>その他</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <h3>変動費</h3>
  <div class="table-control">
    <button id="editSelected">編集</button>
    <button id="deleteSelected">削除</button>
  </div>
  <div class="table-scroll-x">
    <table id="kakeiTable">
      <thead>
        <tr>
          <th>選択</th><th>年月</th><th>カテゴリ</th><th>備考</th><th>支払者</th>
          <th>収入系</th><th>食事関係</th><th>雑貨・生活用品系</th>
          <th>遊び・娯楽関係</th><th>生活費関係</th><th>子供・教育</th><th>その他</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script type="module" src="js/index.js"></script>
</body>
</html>
